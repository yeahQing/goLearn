# 关于defer的理解
首先看代码
```go

func main() {
  x := 1
  y := 2
  defer calc("aa",x,calc("a",x,y))
  x = 10
  defer calc("bb",x,calc("b",x,y))
  y = 20
}

```
在上面的代码中,因为defer的执行类似栈，即先调用的函数，先进栈，后输出。但这里需要注意，defer修饰的函数，起始已经将值传入了函数中，只是没有输出而已。第一个defer calc,向函数中传入了"aa",x,和一个函数返回的y值。

看输出可以发现，函数aa虽然没有输出，但是其内部的函数a已经调用了，这就可以证明，defer修饰的函数虽然没有立刻返回(其只是进行了入栈操作),但其函数内部的操作是已经执行了之后，才入栈的，只是返回和输出是之后执行的。

此外，如果有多个defer修饰的值，则按出栈顺序一次输出。即后调用的defer函数先输出。如果按照java中释放资源的顺序,先使用的后关闭。则用defer表示，应该为：
```go
  //此处以jdbc关闭资源为例
  defer close(conn)
  defer close(pstm)
  defer close(rs)
  /*
    首先结果集先关闭，之后预处理语句的io,最后是释放连接。
  */
```